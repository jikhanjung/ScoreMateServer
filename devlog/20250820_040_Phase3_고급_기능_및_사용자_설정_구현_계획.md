# Phase 3: 고급 기능 및 사용자 설정 구현 계획

**날짜**: 2025년 8월 20일
**작성자**: Gemini
**문서 목적**: `033`번 로드맵 문서를 기반으로, Phase 3에서 구현할 고급 기능과 사용자 설정에 대한 상세 개발 계획을 수립합니다.

---

## 1. 개요

Phase 2에서 세트리스트 관리 기능이 완성됨에 따라, 이제 사용자의 편의성을 높이고 프로덕트의 완성도를 더하는 고급 기능들을 구현할 차례입니다. Phase 3의 목표는 악보 관리의 효율성을 높이는 고급 필터링/벌크 작업, 악보 미리보기, 사용자 개인화 설정을 구현하는 것입니다.

---

## 2. 상세 개발 계획

### Task 1: 악보 목록 페이지 개선 (`/scores`)

- **목표**: 고급 필터링과 여러 악보를 동시에 편집하는 벌크(Bulk) 기능을 추가하여 악보 라이브러리 관리 효율을 극대화합니다.
- **세부 작업**:
    1.  **API 요구사항 확인**: 백엔드 팀과 협력하여 고급 필터링(파일 크기, 페이지 수, 생성/수정일 범위) 및 벌크 태그 수정 API 명세를 확인하고 필요시 조정을 요청합니다.
    2.  **고급 필터 UI 구현**:
        -   악보 목록 상단에 확장/축소 가능한 필터 패널을 추가합니다.
        -   필터 조건 입력을 위한 UI 컴포넌트(날짜 범위 선택, 슬라이더 등)를 구현합니다.
    3.  **필터링 로직 구현**:
        -   `useScores` Custom Hook을 확장하여 필터 상태를 관리합니다.
        -   필터 조건이 변경될 때마다 `react-query`를 통해 API를 호출하고, 목록을 업데이트합니다.
    4.  **벌크 작업 UI 구현**:
        -   악보 목록의 각 항목에 체크박스를 추가합니다.
        -   하나 이상 항목 선택 시, 상단에 "태그 추가", "삭제" 등의 액션 버튼이 포함된 컨텍스트 메뉴를 표시합니다.
    5.  **벌크 작업 로직 구현**:
        -   선택된 악보들의 ID를 수집합니다.
        -   액션 버튼 클릭 시, 해당 API를 호출하여 벌크 업데이트를 수행하고 UI에 결과를 반영합니다. (e.g., Optimistic Update 적용 고려)

### Task 2: 악보 상세 페이지 개선 (`/scores/[id]`)

- **목표**: 사용자가 악보를 다운로드하지 않고 웹에서 바로 확인할 수 있도록 PDF 미리보기 기능을 구현합니다.
- **세부 작업**:
    1.  **PDF 뷰어 라이브러리 선정**: `react-pdf`, `pdf.js` 등의 라이브러리를 기능, 성능, 커뮤니티 지원 측면에서 비교하여 최종 선정합니다.
    2.  **`PdfViewer` 컴포넌트 생성**:
        -   PDF 파일 URL을 props로 받아 렌더링하는 재사용 가능한 컴포넌트를 만듭니다.
        -   로딩 상태, 렌더링 실패 등 예외 상황에 대한 UI를 처리합니다.
    3.  **상세 페이지에 연동**:
        -   `/scores/[id]` 페이지에 `PdfViewer` 컴포넌트를 통합합니다.
        -   악보 상세 정보 API에서 얻어온 PDF 파일 URL을 컴포넌트에 전달합니다.

### Task 3: 사용자 설정 페이지 구현 (`/settings`)

- **목표**: 사용자가 자신의 정보를 직접 관리할 수 있는 페이지를 제공합니다.
- **세부 작업**:
    1.  **설정 페이지 레이아웃 구현**:
        -   `/app/settings/page.tsx` 경로에 페이지를 생성합니다.
        -   "프로필", "계정/보안", "구독 정보" 등 섹션을 구분하기 위한 탭 또는 사이드 메뉴 UI를 구현합니다.
    2.  **프로필 수정 기능**:
        -   사용자 이름, 닉네임 등을 수정할 수 있는 폼을 `react-hook-form`을 사용하여 구현합니다.
        -   '저장' 버튼 클릭 시, 프로필 업데이트 API를 호출합니다.
    3.  **비밀번호 변경 기능**:
        -   "현재 비밀번호", "새 비밀번호", "새 비밀번호 확인" 필드를 포함한 폼을 구현합니다.
        -   API 호출 및 성공/실패 메시지를 사용자에게 명확히 피드백합니다.
    4.  **구독 정보 표시**:
        -   사용자의 현재 구독 플랜, 결제 주기, 상태 등의 정보를 API를 통해 조회하여 읽기 전용으로 표시합니다.

### Task 4: 테스트

- **목표**: 새로 구현된 기능들의 안정성을 보장하기 위해 단위/통합 및 E2E 테스트를 작성합니다.
- **세부 작업**:
    1.  **단위/통합 테스트 (Jest, RTL)**:
        -   `useScores` Hook의 필터링 로직을 테스트합니다.
        -   `PdfViewer` 컴포넌트가 URL을 받아 정상적으로 렌더링되는지 테스트합니다.
        -   설정 페이지의 각 폼 컴포넌트를 테스트합니다.
    2.  **E2E 테스트 (Playwright)**:
        -   필터 적용 → 결과 확인 플로우를 테스트합니다.
        -   여러 악보 선택 → 태그 추가 → 태그 적용 확인 플로우를 테스트합니다.
        -   악보 상세 페이지 진입 → PDF 뷰어 확인 플로우를 테스트합니다.
        -   사용자 프로필 정보 변경 및 비밀번호 변경 플로우를 테스트합니다.

---

## 3. 다음 단계

이 계획을 바탕으로 Claude Code가 실제 구현을 시작하도록 요청합니다. 첫 번째 작업은 **Task 1: 악보 목록 페이지 개선**부터 시작하는 것을 권장합니다.
